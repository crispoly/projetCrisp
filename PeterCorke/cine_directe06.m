function [x, NOAP] = cine_directe06(q)
d1 = 87; d3 = 369.5; d5 = 321; d7 = 67;
a1 = 71;

T01 = [cos(q(1)), 0, sin(q(1)), a1*cos(q(1));...
       sin(q(1)), 0, -cos(q(1)), a1*sin(q(1));...
       0,       1,       0,         d1;...
       0,       0,       0,         1];
     
T12 = [cos(q(2)), 0, sin(q(2)),  0;...
       sin(q(2)), 0, -cos(q(2)), 0;...
       0,       1,       0,  0;...
       0,       0,       0,  1];

T23 = [cos(q(3)), 0, -sin(q(3)),   0;...
       sin(q(3)), 0,  cos(q(3)),   0;...
       0,      -1,       0,    d3;...
       0,       0,       0,    1];

T34 = [cos(q(4)), 0, sin(q(4)),  0;...
       sin(q(4)), 0, -cos(q(4)), 0;...
       0,       1,       0,  0;...
       0,       0,       0,  1];

   
T45 = [cos(q(5)), 0, -sin(q(5)),   0;...
       sin(q(5)), 0,  cos(q(5)),   0;...
       0,      -1,       0,    d5;...
       0,       0,       0,    1];
   
T56 = [cos(q(6)), 0, sin(q(6)),  0;...
       sin(q(6)), 0, -cos(q(6)), 0;...
       0,       1,       0,  0;...
       0,       0,       0,  1];

NOAP = T01*T12*T23*T34*T45*T56;

phi=atan2(NOAP(2,1),NOAP(1,1));
theta=atan2(-NOAP(3,1),cos(phi)*NOAP(1,1)+sin(phi)*NOAP(2,1));
psi=atan2(sin(phi)*NOAP(1,3)-cos(phi)*NOAP(2,3),-sin(phi)*NOAP(1,2)+cos(phi)*NOAP(2,2));
x = [NOAP(1:3,4); psi; theta; phi];

end